I absolutely fell in love with Gentoo Linux several years ago. It is an amazing meta-distribution which you can readily optimize to obtain the best performance, reliability, and compatibility possible. However, unless carefully managed it is guaranteed to suffer from configuration drift. iHowever, the Gentoo project started offering stage3 and a project like this was bound to happen...  AutoGentoo uses Docker Compose to maintain a clean working environment, every time. It creates an optimized buildmaster (and optional distcc workesr) from any of the publicly-available Gentoo stages on Dockerhub. It is subsequently used to compile other packages, as the memory bandwith-heavy performance requirements can be better met by using processor-specific SIMD registers.

Gentoo has existing tools for building base systems, but these aren't really designed for production networks: Although excellent at their specific use-cases, they are ill-suited to the task of customizing a network's worth of installations. This aims to be a production tool as much as a development system. Due to being inspired by Gentoo's existing workflows, it should fit in seamlessly with anyone who already uses Gentoo.

Packages are compiled with FEATURES="binpkg-multi-instance", which allows a single package repository to be shared. This allows, for example, a glibc-based compiler host to compile musl and uclibc versions of a tool that wouldn't be available on their respective Portage profiles due to unmet dependencies. 

While still in its first few days of development it has already proven a smoother and far more reliable experience than any of my past methods. it is currently being developed and tested on AMD/Intel systems but ARM support is coming soon. This was also an excellent excuse to learn Docker in-depth... Docker is a complete game-changer! This app is a little less straightforward than a standard webapp. For example, one complication is that our output targets aren't usually other Docker containers.

Temporary note:
At present this thing in alpha. Some things are subject to change. The master branch is the known-working one, Feel free to also use this as documentation for your own work! Most of the work is checked into tne dev branch and as of February 25 2021 we can expect a merge that implements the rest of the pipeline within a day or so; I've been crafting it intelligently so as to not require (much) rework in the future. More instructions will be forthcoming!


Implementation details:

Our docker-compose file creates persistent volumes for:
``
/var/cache/binpkg
/var/cache/distfiles
/var/db/repos/gentoo
``

Everything else is mounted into temporary containers via bind mounts. Permissions are minded so that we won't experience any stomping. Some files are autogenerated from templates, hence the name AutoGentoo! :)
